(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31928,        745]
NotebookOptionsPosition[     30554,        713]
NotebookOutlinePosition[     30980,        730]
CellTagsIndexPosition[     30937,        727]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["LoadModules", "Title",
 CellChangeTimes->{
  3.96416331056993*^9},ExpressionUUID->"c3cd9e05-e855-4ddc-8381-39060dbb13fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Directory", "[", "]"}], ",", "\"\<HexaBoxModules.m\>\""}], 
     "}"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Directory", "[", "]"}], ",", 
      "\"\<DifferentialOperator.m\>\""}], "}"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$P", "=", 
   RowBox[{
    SuperscriptBox["2", "31"], "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PureIntegrals", "=", 
    RowBox[{"ReadList", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<files/PureIntegralBasisP1.txt\>\""}], "}"}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.964163999327219*^9, {3.96417248430267*^9, 3.9641724879108343`*^9}, {
   3.9651910739349527`*^9, 3.965191085591*^9}, {3.965191122910859*^9, 
   3.96519112424625*^9}, {3.965191169262044*^9, 3.965191169495233*^9}, {
   3.965191213662532*^9, 3.965191244342517*^9}, {3.965191356899208*^9, 
   3.965191358213739*^9}, {3.965191451254923*^9, 3.965191452941985*^9}, {
   3.965206917079507*^9, 3.965206917287602*^9}, {3.9653826800002813`*^9, 
   3.965382718338017*^9}, {3.965979986015718*^9, 3.965979987278985*^9}, 
   3.966059373841085*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"dc6f7cdd-c58e-40fc-864a-b1b20c61b07a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Phase-Space Points", "Title",
 CellChangeTimes->{{3.964163321998597*^9, 
  3.9641633291978903`*^9}},ExpressionUUID->"239eda9e-fc2e-49b7-97ac-\
09548e051831"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DeleteOldKiraRun", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tpointlist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tpoint", "=", 
   RowBox[{"GetRandomPT", "[", 
    RowBox[{"0", ",", "$P"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"Npos", "=", "1"}], ",", 
      RowBox[{"Npos", "<=", "10"}], ",", 
      RowBox[{"Npos", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tpoint", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
        RowBox[{"RandomInteger", "[", "$P", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tpointlist", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"tpointlist", ",", 
          RowBox[{"{", 
           RowBox[{"tpoint", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Npos", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WriteNumericsFile", "[", "tpoint", "]"}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AddToNumericsFile", "[", "tpoint", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"ProgressIndicator", "[", 
    RowBox[{"Npos", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "10"}], "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.962693851353387*^9, 3.962693886553146*^9}, 
   3.962695182752883*^9, {3.962698528753879*^9, 3.9626985513623257`*^9}, {
   3.9626993777786617`*^9, 3.96269938660944*^9}, {3.962699817233783*^9, 
   3.962699817346437*^9}, 3.962699918840705*^9, {3.96270002304937*^9, 
   3.962700024785594*^9}, {3.9627010419542522`*^9, 3.962701089097093*^9}, 
   3.962956361588681*^9, {3.963310810212413*^9, 3.963310815865594*^9}, {
   3.963310893460414*^9, 3.9633108938887653`*^9}, {3.963546921606563*^9, 
   3.963547031215472*^9}, 3.963547101951516*^9, {3.963547463311987*^9, 
   3.963547479679195*^9}, {3.9635476580327253`*^9, 3.963547721063188*^9}, {
   3.9635483725047626`*^9, 3.9635483737833347`*^9}, {3.96354853464797*^9, 
   3.9635485473202753`*^9}, {3.963548615600317*^9, 3.963548616527725*^9}, {
   3.963548949197147*^9, 3.963548983135206*^9}, {3.96355925876064*^9, 
   3.963559312432477*^9}, {3.96356801986497*^9, 3.9635680224803553`*^9}, {
   3.96416382116535*^9, 3.9641638448309917`*^9}, {3.964172478470724*^9, 
   3.964172482078733*^9}, {3.964503444830888*^9, 3.964503460157819*^9}, {
   3.964507722694585*^9, 3.9645077302790527`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"3ed7df82-b5ba-452a-8953-46edce8a8999"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parallel Reduction", "Title",
 CellChangeTimes->{
  3.96416341348995*^9},ExpressionUUID->"dbc0644d-bcdf-48f2-be90-7bd85bcf96ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ComputeDI", "[", "samplepoint_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "SubReduList", ",", "ReductionRules", ",", "ExtraRelations", ",", 
       "tpoint", ",", "diffop", ",", "kinematicsT", ",", 
       "loopMomentumScalarProductsT", ",", "mandelstamScalarProductsT", ",", 
       "dhxbAll", ",", "ReducedDiffrential", ",", "NULLS", ",", 
       "dhxbMatrices", ",", "dhxbMatricesSaveFormat", ",", "reductionRules", 
       ",", "PureIntegralN", ",", "diffOp", ",", "eps", ",", "tPoint", ",", 
       "repl", ",", "PureIntegralN2", ",", "Basis", ",", "NullInts", ",", 
       "BasisChangMat", ",", "BasisChangMatInv", ",", "diffInts", ",", 
       "diffIntsIBREDUCED", ",", "NonReduced", ",", "NullInts2", ",", 
       "epsrepl", ",", "ZeroInts", ",", "ZeroIntsRepl", ",", "PureIntegralN3",
        ",", "PureIntegralN4", ",", "SubLaporta", ",", "NonZeros", ",", 
       "DeleteList"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SubReduList", "=", 
       RowBox[{"Get", "[", 
        RowBox[{"ToString", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<``/KIRA/splitres/phasespace_``.m\>\"", ",", 
           RowBox[{"Directory", "[", "]"}], ",", 
           RowBox[{"IntegerString", "[", 
            RowBox[{"samplepoint", ",", "10", ",", "5"}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tPoint", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"Rule", "[", 
         RowBox[{"invariants", ",", 
          RowBox[{"SubReduList", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reductionRules", "=", 
       RowBox[{"ReductionRules", "=", 
        RowBox[{"GetReductionTableFromList", "[", 
         RowBox[{"SubReduList", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PureIntegralN", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PureIntegrals", "/.", "tPoint"}], "/.", 
          RowBox[{
           RowBox[{"root", "[", "n_", "]"}], ":>", 
           RowBox[{"PowerMod", "[", 
            RowBox[{"n", ",", 
             RowBox[{"1", "/", "2"}], ",", "$P"}], "]"}]}]}], ",", 
         RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"diffOp", "=", 
       RowBox[{"getDifferentialOperator", "[", "tPoint", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"epsrepl", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ep", "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "-", "d"}], ")"}], "/", "2"}]}], ")"}], "/.", 
         "tPoint"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ExtraRelations", "=", 
       RowBox[{"GetExtraRelationReplacements", "[", 
        RowBox[{"reductionRules", ",", "tPoint"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PureIntegralN2", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"PureIntegralN", "/.", "reductionRules"}], ",", 
         RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PureIntegralN3", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"PureIntegralN2", "/.", "ExtraRelations"}], ",", 
         RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"NonZeros", "=", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"reductionRules", ",", "_hxb", ",", "Infinity"}], "]"}], "//",
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ZeroInts", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"Ureduce", ",", "NonZeros"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ZeroIntsRepl", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"Rule", "[", 
         RowBox[{"ZeroInts", ",", "0"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PureIntegralN4", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PureIntegralN3", "/.", "ExtraRelations"}], "/.", 
          "ZeroIntsRepl"}], ",", 
         RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SubLaporta", "=", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"PureIntegralN4", ",", "_hxb", ",", "Infinity"}], "]"}], "//",
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PureIntegralN4", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"PureIntegralN4", "/.", "epsrepl"}], ",", 
         RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BasisChangMat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{
           RowBox[{"PureIntegralN4", "[", 
            RowBox[{"[", "pos", "]"}], "]"}], ",", "SubLaporta"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"pos", ",", "1", ",", 
           RowBox[{"Length", "[", "PureIntegralN", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"BasisChangMat", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"BasisChangMat", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BasisChangMatInv", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"BasisChangMat", ",", 
         RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"loopMomentumScalarProductsT", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"loopMomentumScalarProducts", "/.", "tPoint"}], ",", 
         RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mandelstamScalarProductsT", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"mandelstamScalarProducts", "/.", "tPoint"}], ",", 
         RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DeleteList", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", 
           ",", "8", ",", "9", ",", "10", ",", "11"}], "}"}], ",", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"tPoint", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "s16"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diffInts", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"applyDifferentialOperator", "[", 
                    RowBox[{
                    RowBox[{"Collect", "[", 
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"diffOp", ",", 
                    RowBox[{"ds", "[", 
                    RowBox[{"invariantsnodUpperCase", "[", 
                    RowBox[{"[", "var", "]"}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"del", "[", "___", "]"}]}], "]"}], ",", 
                    RowBox[{"Expand", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PureIntegrals", "[", 
                    RowBox[{"[", "intpos", "]"}], "]"}], "/.", 
                    RowBox[{"tPoint", "[", 
                    RowBox[{"[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"DeleteList", ",", 
                    RowBox[{"var", "+", "1"}]}], "]"}], "]"}], "]"}]}], "/.", 
                    "epsrepl"}], ",", 
                    RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], "]"}], "/.", 
                   "tPoint"}], "/.", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"root", "'"}], "[", "x_", "]"}], ":>", 
                   RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"root", "[", "x", "]"}]}], ")"}]}]}]}], ")"}], "/.", 
                RowBox[{
                 RowBox[{"root", "[", "x_", "]"}], ":>", 
                 RowBox[{"PowerMod", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"1", "/", "2"}], ",", "$P"}], "]"}]}]}], ",", 
               RowBox[{"Modulus", "->", "$P"}]}], "]"}], "/.", 
             "loopMomentumScalarProductsT"}], "/.", 
            "mandelstamScalarProductsT"}], ",", 
           RowBox[{"Modulus", "->", "$P"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"var", ",", "1", ",", 
           RowBox[{"Length", "[", "invariantsnodUpperCase", "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"intpos", ",", "1", ",", 
           RowBox[{"Length", "[", "PureIntegrals", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diffIntsIBREDUCED", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"diffInts", "/.", "reductionRules"}], "/.", 
          "ExtraRelations"}], ",", 
         RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NonReduced", "=", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"diffIntsIBREDUCED", ",", "_hxb", ",", "Infinity"}], "]"}], "//",
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NullInts2", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"NonReduced", ",", "SubLaporta"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"diffIntsIBREDUCED", "=", 
       RowBox[{"diffIntsIBREDUCED", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"Rule", "[", 
          RowBox[{"NullInts2", ",", "0"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dhxbMatrices", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{
            RowBox[{"CoefficientArrays", "[", 
             RowBox[{
              RowBox[{"diffIntsIBREDUCED", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "SubLaporta"}], 
             "]"}], "/.", 
            RowBox[{
             RowBox[{"{", "0", "}"}], "->", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"Length", "[", "PureIntegralN", "]"}]}], "]"}]}], 
              "}"}]}]}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "invariants", "]"}], "-", "1"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "SubLaporta", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", 
         RowBox[{"Length", "[", "invariantsnod", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"dhxbMatrices", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Expand", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dhxbMatrices", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", "BasisChangMatInv"}], ",", 
            
            RowBox[{"Modulus", "->", "$P"}]}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dhxbMatricesSaveFormat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"dhxbMatrices", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "invariantsnod", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tPoint", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         "dhxbMatricesSaveFormat"}], "}"}], "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.963559996936307*^9, 3.963560006240045*^9}, {
   3.963560055439834*^9, 3.963560131727468*^9}, {3.963560338848765*^9, 
   3.9635603589285088`*^9}, {3.963560456362381*^9, 3.963560491497765*^9}, {
   3.963560677105055*^9, 3.9635606783367434`*^9}, {3.9635607238249598`*^9, 
   3.963560724120514*^9}, {3.963560884137282*^9, 3.963560884296474*^9}, {
   3.963561386105233*^9, 3.96356143193694*^9}, {3.963561481992826*^9, 
   3.963561594593732*^9}, {3.963561628361833*^9, 3.9635616681855593`*^9}, {
   3.963561944634378*^9, 3.963561973192205*^9}, {3.9635634215286283`*^9, 
   3.963563438945496*^9}, {3.963565737872273*^9, 3.9635657699606323`*^9}, 
   3.963565998138308*^9, {3.9635660860338697`*^9, 3.963566095496339*^9}, {
   3.963566146190804*^9, 3.963566153848263*^9}, {3.963566249776176*^9, 
   3.963566259408298*^9}, {3.963566420776256*^9, 3.96356642298461*^9}, {
   3.963566634128039*^9, 3.963566638801087*^9}, {3.9635675278247747`*^9, 
   3.9635675309454403`*^9}, {3.96356857823664*^9, 3.963568598049377*^9}, {
   3.9635695676891603`*^9, 3.9635695700080967`*^9}, 3.963569824440876*^9, {
   3.963569995832828*^9, 3.963570000136622*^9}, 3.963570224656001*^9, {
   3.963570853848278*^9, 3.963570860096176*^9}, {3.963573985881085*^9, 
   3.963573997992407*^9}, {3.963574046640985*^9, 3.963574069000936*^9}, {
   3.963574104248693*^9, 3.9635741050088587`*^9}, {3.963574223608933*^9, 
   3.963574277417454*^9}, {3.963574322088749*^9, 3.963574355384758*^9}, {
   3.963893015097535*^9, 3.963893052456244*^9}, {3.96389467590441*^9, 
   3.963894719984391*^9}, {3.963894764880889*^9, 3.963894767338166*^9}, {
   3.963895065248493*^9, 3.96389507715219*^9}, {3.964163437894713*^9, 
   3.964163438054352*^9}, {3.9641635246309834`*^9, 3.964163530798028*^9}, {
   3.9641635731432037`*^9, 3.964163785983862*^9}, {3.9641638685595627`*^9, 
   3.964163918791362*^9}, {3.964163988919978*^9, 3.964163989686831*^9}, {
   3.964164937982225*^9, 3.964164939990365*^9}, {3.964164984407054*^9, 
   3.964165029470426*^9}, {3.964165171542667*^9, 3.9641651995903397`*^9}, {
   3.964165330026003*^9, 3.96416533838958*^9}, {3.964165368438758*^9, 
   3.964165371061943*^9}, 3.9641655093830357`*^9, {3.964165647998363*^9, 
   3.964165667030324*^9}, {3.964165864678331*^9, 3.96416595165403*^9}, {
   3.964172465543293*^9, 3.9641724657587843`*^9}, {3.9645038665588417`*^9, 
   3.964503870598036*^9}, 3.965119382300778*^9, 3.9651910996467752`*^9, {
   3.965206920144178*^9, 3.965206920264175*^9}, {3.9652902508594723`*^9, 
   3.965290251844117*^9}, {3.965447080947071*^9, 3.965447167709248*^9}, {
   3.9654472238211327`*^9, 3.9654472830608177`*^9}, 3.9654477455417633`*^9, {
   3.965447822974558*^9, 3.96544782677175*^9}, {3.96544794437259*^9, 
   3.965447950430396*^9}, {3.965448549413747*^9, 3.965448568971957*^9}, {
   3.965980016726804*^9, 3.965980029526104*^9}, 3.965980086746603*^9, {
   3.9659896256005783`*^9, 3.96598964028795*^9}, 3.965989817656362*^9, {
   3.966059301868182*^9, 3.9660593374285727`*^9}, {3.966060287461302*^9, 
   3.9660603039300203`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"17653766-a98e-4e62-b923-30e1708e0a23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kernels", "=", 
   RowBox[{"LaunchKernels", "[", "10", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directory", "[", "]"}], ",", "\"\<HexaBoxModules.m\>\""}], 
       "}"}], "]"}], "]"}], ",", "kernels"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directory", "[", "]"}], ",", 
        "\"\<DifferentialOperator.m\>\""}], "}"}], "]"}], "]"}], ",", 
    "kernels"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PureIntegrals", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directory", "[", "]"}], ",", 
          "\"\<files/PureIntegralBasisP1.txt\>\""}], "}"}], "]"}], "]"}]}], 
     ";"}], ",", "kernels"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.963560500528365*^9, 3.963560540240906*^9}, 
   3.9635606845614758`*^9, {3.9635617425142603`*^9, 3.963561743368739*^9}, {
   3.963562752331224*^9, 3.963562753095827*^9}, {3.9635634730984*^9, 
   3.96356348455189*^9}, {3.963564985048009*^9, 3.963564999423883*^9}, {
   3.9635653627005167`*^9, 3.963565364655699*^9}, {3.963565478696166*^9, 
   3.963565566711666*^9}, {3.963566243552074*^9, 3.9635662437360086`*^9}, {
   3.963566516472639*^9, 3.963566535689749*^9}, {3.963566953953594*^9, 
   3.9635669643121443`*^9}, 3.963567541222104*^9, {3.96356772269702*^9, 
   3.963567722864953*^9}, {3.963568546405952*^9, 3.963568552176714*^9}, 
   3.963569579966229*^9, {3.96357083357859*^9, 3.963570836350716*^9}, {
   3.963893105824018*^9, 3.9638931160876827`*^9}, {3.964164725478098*^9, 
   3.9641648599815187`*^9}, {3.964172650334249*^9, 3.964172650526256*^9}, {
   3.964503744238736*^9, 3.964503744318309*^9}, {3.964507921880746*^9, 
   3.964507921989853*^9}, 3.9651910925193787`*^9, {3.965207312199761*^9, 
   3.965207312335557*^9}, {3.96544730878343*^9, 3.965447310946949*^9}, {
   3.9654479785988693`*^9, 3.965447989027503*^9}, {3.965980005927658*^9, 
   3.965980007198625*^9}, 3.966059377605879*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"97f67eb9-be4d-4be2-b709-62ea78b391e3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"parallelOut", "=", 
   RowBox[{
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"ComputeDI", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}], "//", 
    "EchoTiming"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.963560500528365*^9, 3.963560540240906*^9}, 
   3.9635606845614758`*^9, {3.9635617425142603`*^9, 3.963561743368739*^9}, {
   3.963562752331224*^9, 3.963562753095827*^9}, {3.9635634730984*^9, 
   3.96356348455189*^9}, {3.963564985048009*^9, 3.963564999423883*^9}, 
   3.9635653627005167`*^9, 3.963565781040423*^9, {3.963565854256576*^9, 
   3.9635658924156103`*^9}, 3.963566013632375*^9, {3.963566274320644*^9, 
   3.963566277407873*^9}, {3.963566319215623*^9, 3.963566329488125*^9}, {
   3.963566439984538*^9, 3.963566511144635*^9}, {3.963567514112337*^9, 
   3.96356751759234*^9}, 3.9635677501770887`*^9, {3.9635678636995907`*^9, 
   3.963567865511943*^9}, {3.963568416027094*^9, 3.9635684183381357`*^9}, 
   3.963568575570416*^9, {3.963569643400147*^9, 3.963569678177114*^9}, {
   3.963574120019024*^9, 3.963574120424802*^9}, {3.963574288738454*^9, 
   3.96357428987219*^9}, {3.9638950872957497`*^9, 3.963895116983787*^9}, {
   3.9638951880001373`*^9, 3.963895210408304*^9}, {3.963895471553253*^9, 
   3.9638954719526043`*^9}, {3.9641649022047787`*^9, 3.964164907324869*^9}, {
   3.964165677862636*^9, 3.96416568627728*^9}, {3.9641660911740017`*^9, 
   3.9641660961021767`*^9}, 3.964172653581856*^9, 3.964503766173856*^9, 
   3.964507923774872*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"f5a011ec-460e-45da-abe9-716e773920f2"],

Cell[BoxData["330.515493`"], "EchoTiming",
 CellChangeTimes->{
  3.9660606499348516`*^9},ExpressionUUID->"e9e412ed-7b0e-47a0-a7aa-\
d1fcb6aa035c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dhxbMatrices", "=", 
   RowBox[{"parallelOut", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tpoints", "=", 
   RowBox[{"parallelOut", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OutPutPath", "=", "\"\<ParralelD10\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"OpenAppend", ",", 
    RowBox[{"PageWidth", "->", "Infinity"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeleteDirectory", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "OutPutPath"}], "}"}], 
     "]"}], ",", 
    RowBox[{"DeleteContents", "->", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateDirectory", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "OutPutPath"}], "}"}], 
    "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"q", "=", "1"}], ",", 
    RowBox[{"q", "<=", 
     RowBox[{"Length", "[", "dhxbMatrices", "]"}]}], ",", 
    RowBox[{"q", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PutAppend", "[", 
      RowBox[{
       RowBox[{"tpoints", "[", 
        RowBox[{"[", "q", "]"}], "]"}], ",", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<``/parameters\>\"", ",", "OutPutPath"}], "]"}], 
           "]"}]}], "}"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", 
    RowBox[{"Length", "[", "invariantsnod", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"q", "=", "1"}], ",", 
      RowBox[{"q", "<=", 
       RowBox[{"Length", "[", "dhxbMatrices", "]"}]}], ",", 
      RowBox[{"q", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PutAppend", "[", 
        RowBox[{
         RowBox[{"dhxbMatrices", "[", 
          RowBox[{"[", 
           RowBox[{"q", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<``/DEmatrix_d``\>\"", ",", "OutPutPath", ",", 
               RowBox[{"invariants", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
           "}"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.963311387956378*^9, 3.9633113972362547`*^9}, {
   3.963311531885043*^9, 3.963311706580181*^9}, {3.9633118361061697`*^9, 
   3.9633119163720303`*^9}, {3.963384165561101*^9, 3.963384227152124*^9}, {
   3.96338442623307*^9, 3.963384527559972*^9}, {3.963384564368743*^9, 
   3.963384587759718*^9}, {3.96338500376007*^9, 3.96338502179161*^9}, {
   3.963385129583221*^9, 3.9633851454721317`*^9}, {3.963385226855605*^9, 
   3.963385256984355*^9}, {3.9633853340339117`*^9, 3.9633853341837893`*^9}, {
   3.963385491265291*^9, 3.963385624401552*^9}, {3.96356421724888*^9, 
   3.963564225216535*^9}, {3.963564255640562*^9, 3.963564364840292*^9}, {
   3.963564408128079*^9, 3.963564421656273*^9}, {3.96356446037781*^9, 
   3.963564461395859*^9}, {3.964167239326354*^9, 3.9641673152450857`*^9}, 
   3.965447298739128*^9, {3.9654484604996567`*^9, 3.965448461146587*^9}, 
   3.96544857554692*^9, {3.965980119359654*^9, 3.9659801444624023`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"8e9427dc-a6aa-4c6a-b1b9-1452a795a8e5"]
}, Open  ]]
},
WindowSize->{1263.75, 1028.25},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"13.3 for Linux x86 (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8dc1daf9-d663-4d21-9a63-af01024c9abb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 127, 2, 117, "Title",ExpressionUUID->"c3cd9e05-e855-4ddc-8381-39060dbb13fc"],
Cell[710, 26, 1720, 43, 184, "Input",ExpressionUUID->"dc6f7cdd-c58e-40fc-864a-b1b20c61b07a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2467, 74, 172, 3, 117, "Title",ExpressionUUID->"239eda9e-fc2e-49b7-97ac-09548e051831"],
Cell[2642, 79, 2883, 62, 308, "Input",ExpressionUUID->"3ed7df82-b5ba-452a-8953-46edce8a8999"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5562, 146, 134, 2, 117, "Title",ExpressionUUID->"dbc0644d-bcdf-48f2-be90-7bd85bcf96ca"],
Cell[5699, 150, 16322, 359, 1545, "Input",ExpressionUUID->"17653766-a98e-4e62-b923-30e1708e0a23"],
Cell[22024, 511, 2551, 56, 135, "Input",ExpressionUUID->"97f67eb9-be4d-4be2-b709-62ea78b391e3"],
Cell[CellGroupData[{
Cell[24600, 571, 1641, 28, 35, "Input",ExpressionUUID->"f5a011ec-460e-45da-abe9-716e773920f2"],
Cell[26244, 601, 146, 3, 29, "EchoTiming",ExpressionUUID->"e9e412ed-7b0e-47a0-a7aa-d1fcb6aa035c"]
}, Open  ]],
Cell[26405, 607, 4133, 103, 382, "Input",ExpressionUUID->"8e9427dc-a6aa-4c6a-b1b9-1452a795a8e5"]
}, Open  ]]
}
]
*)

